import pytest
from src.vulnerability_analysis import VulnerabilityAnalyzer

def test_run_comprehensive_analysis():
    analyzer = VulnerabilityAnalyzer()
    results = analyzer.run_comprehensive_analysis()
    assert isinstance(results, dict)
    assert "analysis_timestamp" in results
    assert "system_info" in results
    assert "cve_analysis" in results
    assert "risk_assessment" in results
    assert isinstance(results["risk_assessment"], dict)
    assert "overall_score" in results["risk_assessment"]
    assert "risk_level" in results["risk_assessment"]
